{# templates/pedidos/pedidos.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Mis Pedidos - Wembli{% endblock %}

{% block contenido %}
    <div style="max-width: 900px; margin: 0 auto;">
        <h2 style="color:#1E3A8A; margin-bottom:20px;">üì¶ Mis Pedidos</h2>

        {% if pedidos is not empty %}
            {% for pedido in pedidos %}
                <div style="background-color: #F3F4F6; border: 1px solid #E5E7EB; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                    <h3 style="color: #1E40AF; margin: 0 0 10px 0;">
                        Pedido #{{ pedido.id }} 
                        <span style="color: #6B7280; font-size: 0.9em;">
                            - {{ pedido.fecha|date('d/m/Y H:i') }}
                        </span>
                    </h3>
                    
                    <table style="width:100%; border-collapse: collapse; text-align:left; margin-bottom: 15px;">
                        <thead>
                            <tr style="background-color:#1E40AF; color:white;">
                                <th style="padding:10px;">Producto</th>
                                <th>Precio Unitario</th>
                                <th style="text-align: center;">Unidades</th>
                                <th style="text-align: right;">Subtotal</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in pedido.pedidoProductos %}
                                <tr style="border-bottom:1px solid #E5E7EB;">
                                    <td style="padding:8px;">{{ item.producto.nombre }}</td>
                                    <td>{{ item.producto.precio|number_format(2, ',', '.') }} ‚Ç¨</td>
                                    <td style="text-align: center;">{{ item.unidades }}</td>
                                    <td style="text-align: right;">{{ (item.producto.precio * item.unidades)|number_format(2, ',', '.') }} ‚Ç¨</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                        <tfoot>
                            <tr style="background-color: #EFF6FF; font-weight: bold;">
                                <td colspan="3" style="padding:10px; text-align:right;">TOTAL:</td>
                                <td style="text-align: right; padding: 10px;">{{ pedido.coste|number_format(2, ',', '.') }} ‚Ç¨</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            {% endfor %}
        {% else %}
            <div style="background-color: #FEF3C7; border: 2px solid #F59E0B; padding: 20px; border-radius: 8px; text-align: center;">
                <p style="color: #78350F; font-size: 18px; margin: 0;">
                    üì¶ No has realizado ning√∫n pedido a√∫n.
                </p>
                <a href="{{ path('categorias') }}" 
                   style="display: inline-block; margin-top: 15px; padding: 10px 20px; background-color: #F59E0B; color: white; text-decoration: none; border-radius: 5px;">
                   Ir a Comprar
                </a>
            </div>
        {% endif %}

        <div style="margin-top: 30px; text-align: center;">
            <a href="{{ path('categorias') }}" 
               style="padding: 10px 20px; background-color: #1E40AF; color: white; text-decoration: none; border-radius: 5px;">
               üè† Volver a Categor√≠as
            </a>
        </div>
    </div>
{% endblock %}
